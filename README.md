
# Safety bot

## Inspiration
The Safety Bot is designed to serve the public and improve road safety. It caters to users' needs by  addressing certain administrative concerns such as open drains, potholes, street lighting, traffic light malfunction etc by registering complain with corporation. This way we can reduce manual intervention and serve the public efficiently. I believe that technology, in this case AI applied to an assistant,  has the potential to make life better and safer for a lot of people.

## What it does?
The Safety Bot has 2 main functions, the first one is to capture users needs to understand the main concern and get the appropriate location related to the concern.  Example of one such concern from the user: "The traffic lights are not working in Velachery Main Road".  Here, the bot understands that the concern is about the traffic light and gets the location "Velachery Main Road". The bot is trained with specific set of questions and we can add more in future to cater to different needs.  

The second functionality of this bot is to inform the corporation regarding the issue along with the location details. A mechanism will be included to catch unanswered queries, save them in a database and add them to the crowdsource queue.



# Installation

Confirm you have NodeJs 10.x or higher

```bash
Node-v
```

Install the code dependencies

```
yarn install
```

Enable .env file

```bash
mv .sample.env .env
```

Add App IDs and Secrets to `.env` configuration

_more info at: https://developers.facebook.com/docs/messenger-platform/introduction_

```bash
vim .env
```

Things to update:

```
PAGE_ID=
APP_ID=
PAGE_ACCESS_TOKEN=
APP_SECRET=
VERIFY_TOKEN=<ANY STRING YOU'LL REMEMBER>
```


# Usage

In order to receive messages, we need to be able to get incoming webhooks from Facebook Servers. So we need an external address, a quick way to do this is to use NGROK since it will provide an external https address that will tunnel into your NodeJS running app.

1- Install NGROK in your computer, go to the link and follow the instructions:

https://dashboard.ngrok.com/get-started/setup

2- run in port 80

```bash
./ngrok http 80
```


#### 3. ADD TUNNEL URL:

Inside the `.env` config, add the URL provided by NGROK:

```bash
APP_URL=https://<AUTOGENERATED>.ngrok.io
```

⚠️ You need to update `APP_URL`  everytime you close the terminal running NGROK.


#### 4. In the root of the project run app locally:

```bash
node app.js
```
 
 #### 5. Confirm is running by visiting this URL in your browser

`http://localhost:80/`

_You should be able to see a welcome Message._


#### 6. Confirm Token
Pay attention to the Command Line, it will provide you with an URL that you need to visit in order to validate the token.  _it looks similar to this:_

`https://xxxxxxxx.ngrok.io/profile?mode=all&verify_token=xxxxxxx`


#### 7. Test your app 
Go to the link provided by the Terminal, _it looks similar to this:_

`https://m.me/xxxxxx`

#### 8. Test that your app setup is successful

  Send a message to your Page from Facebook or in Messenger, if your webhook receives an event, you have fully set up your app! Voilà!








